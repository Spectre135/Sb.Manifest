"use strict";var app=angular.module("SbManifest");app.controller("customerCtrl",(function($scope,$state,$mdDialog,apiService,config){$scope.data=$state.params.data,$scope.list=$state.params.list,$scope.myPage=$state.params.page,$scope.myLimit=$state.params.limit,$scope.myOrder=$state.params.order,$scope.query={order:"name",limit:5,page:1},$scope.rows=$state.params.rows,$scope.getCustomerList=function(){$scope.myPage=1;var url=config.manifestApi+"/customer/list",params={};apiService.getData(url,params,!0).then((function(data){$scope.list=data.DataList,$scope.rows=data.RowsCount}))},$scope.getInvoice=function($event,dto){$mdDialog.show({locals:{dataToPass:dto},controller:"invoiceCtrl",controllerAs:"ctrl",templateUrl:"app/components/invoice/invoice.html",parent:angular.element(document.body),targetEvent:$event,clickOutsideToClose:!1,onRemoving:function(event,removePromise){$scope.getCustomerList()}})},$scope.editCustomer=function($event,dto){$mdDialog.show({locals:{dataToPass:dto},controller:"editCustomerCtrl",controllerAs:"ctrl",templateUrl:"app/components/customers/editCustomer.html",parent:angular.element(document.body),targetEvent:$event,clickOutsideToClose:!1,onRemoving:function(event,removePromise){$scope.getCustomerList()}})},$scope.init=function(){$scope.getCustomerList()}})),app.controller("editCustomerCtrl",(function($scope,$mdDialog,dataToPass,apiService,config){var self=this;$scope.warning=null,$scope.customer=dataToPass,$scope.label=null==$scope.customer?"Add new customer":"Edit "+$scope.customer.Name,$scope.countries,this.cancel=function($event){$mdDialog.cancel()},this.save=function($event){var url=config.manifestApi+"/customer/save";apiService.postData(url,$scope.customer,!0).then((function(){$mdDialog.hide()}))},$scope.getCountries=function(){$scope.workingCountries=!0;var url=config.manifestApi+"/settings/countries",promise;return apiService.getData(url,null,!1).then((function(data){$scope.countries=data.DataList}))}}));